<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.4.2.3 (MacOSX)"/>
	<meta name="created" content="2013-06-11T00:00:00.020113632"/>
	<meta name="changed" content="2023-09-07T08:55:18.330275334"/>
	<meta name="created" content="00:00:00">
	<meta name="created" content="00:00:00">
	<style type="text/css">
		@page { margin: 0.79in }
		h1 { margin-bottom: 0.08in }
		h1.western { font-family: "Arial", sans-serif; font-size: 16pt }
		h1.cjk { font-family: "Microsoft YaHei"; font-size: 16pt }
		h1.ctl { font-family: "Mangal"; font-size: 16pt }
		p { margin-bottom: 0.08in }
		pre.western { font-family: "Courier New", monospace }
		pre.cjk { font-family: "NSimSun", monospace }
		pre.ctl { font-family: "Courier New", monospace }
		h2 { margin-bottom: 0.08in }
		h2.western { font-family: "Arial", sans-serif; font-size: 14pt; font-style: italic }
		h2.cjk { font-family: "Microsoft YaHei"; font-size: 14pt; font-style: italic }
		h2.ctl { font-family: "Mangal"; font-size: 14pt; font-style: italic }
		a:link { so-language: zxx }
	</style>
</head>
<body lang="en-US" dir="ltr"><h1 class="western" align="center" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
User Guide<br/>
Csound for Android 
</h1>
<p align="center" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
<i><b>Michael Gogins</b></i></p>
<p align="center" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
<i><b>31 August 2023</b></i></p>
<p align="center" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
<br/>

</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">This
is an extremely basic guide to using the Csound for Android app. It
should be just enough to get you started if you already have some
experience with Csound or, at least, some other “Music N” type
software synthesizer.</p>
<h1 class="western" style="line-height: 115%">Release Notes</h1>
<h2 class="western">Version 39</h2>
<p>This is a bug fix release. The sizes and spacings of the buttons,
labels, and sliders in the <i><b>Widgets</b></i> tab have been
refined in order to display more widgets on smartphones.</p>
<h2 class="western">Version 38</h2>
<p>This is a bug fix release. The editor size was misbehaving when
the mobile keyboard appeared or disappeared; fixed by changing the
host element for the editor back to <font face="Courier New, monospace">&lt;div&gt;</font>
from <font face="Courier New, monospace">&lt;pre&gt;</font>.</p>
<h1 class="western">Introduction</h1>
<p>The Csound for Android app now targets Android version 13; this is
the first major release of the app since 2021. This has required
adding <font face="Courier New, monospace">MANAGE_EXTERNAL_STORAGE</font>
permission, so that the app can now read and write all files on a
device. Be assured that the app does not, on its own, read any
private data, or send any private data anywhere, or download any data
or software on its own. Of course, a user could write a .csd file
that can do these things, so exercise due care.</p>
<p>Android versions from 10 forward are still supported.</p>
<h2 class="western">Upgraded libraries</h2>
<ul>
	<li><p>Csound has been upgraded to version 6.18.1.</p>
	<li><p>Google’s Oboe audio driver wrapper has been upgraded to
	version 1.7.5.</p>
	<li><p>The Ace Editor has been upgraded to version 1.24.1. 
	</p>
	<li><p>Various plugin opcode libraries have been upgraded.</p>
</ul>
<h2 class="western">Enhanced Functionality</h2>
<ul>
	<li><p>The widgets are now arranged with one button to the left of
	each slider, and the number of buttons and sliders has been
	increased to 12 each.</p>
	<li><p>The code editor now has visible scrollbars, faster scrolling,
	and a context menu for search and replace, configuring the editor,
	etc.</p>
	<li><p>The <i><b>User Guide</b></i> has been improved with
	instructions for using an Android emulator to run the app on
	notebooks or desktops.</p>
	<li><p>The data from <i>all</i> accessible sensors on a device are
	now routed to Csound event channels. The names of the sensors are
	printed to the <i><b>Messages</b></i> pane when Csound starts up.
	The names of the corresponding Csound control channels are the same
	but with the index of the value appended, e.g. the <font face="Courier New, monospace">accelerometer</font>
	sensor events convey three values, so its Csound control channel
	names are <font face="Courier New, monospace">accelerometer1</font>,
	<font face="Courier New, monospace">accelerometer2</font>, and
	<font face="Courier New, monospace">accelerometer3</font>.</p>
</ul>
<h2 class="western">Bug Fixes</h2>
<ul>
	<li><p>The app no longer crashes when run without first loading a
	.csd file.</p>
	<li><p>The broken link to the online <i><b>Csound Reference Manual</b></i>
	has been fixed.</p>
	<li><p>A number of plugin opcode libraries that went missing in the
	Android build have now been restored.</p>
	<li><p>A bug in requesting permission to write files in Android 11
	and higher has been fixed.</p>
</ul>
<h2 class="western">Downgraded Functionality</h2>
<ul>
	<li><p>The Ableton Link opcodes have been removed.</p>
	<li><p>The LuaJit opcodes have been removed.</p>
</ul>
<h1 class="western" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
Introduction</h1>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
Csound for Android app is an Android version of Csound, an audio and
music synthesis and processing language of great power, created by
Barry Vercoe in 1984, maintained with almost complete backward
compatibility since then, and widely used and taught for the creation
of electroacoustic and computer music. Despite its age, Csound
continues to be actively developed. It has many advanced features for
sound synthesis including user-designable instruments, an easy to
learn programming language, several phase vocoders, several sample
players, a plethora of digital oscillators, filters, and envelope
generators, and transparent multi-threading for higher performance of
some types of pieces on multi-core systems.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
Csound for Android app is by Victor Lazzarini, Steven Yi, Michael
Gogins, and others, and is currently maintained by Michael Gogins in
the <a href="https://github.com/gogins/csound-android">csound-android</a>
repository. The app contains virtually all of Csound, including many
of the more frequently used plugin opcodes:</p>
<ul>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	The signal flow graph opcodes, for chaining instruments into effects
	chains and so on.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	The Fluidsynth opcodes for playing SF2 samples.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	The libstdutil library.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	The scanned synthesis opcodes.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	The Open Sound Control (OSC) opcodes which allow Csound to
	communicate over networks with other software in a low-latency and
	flexible manner.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	The Doppler opcode.</p>
</ul>
<h1 class="western" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
User Interface</h1>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
Csound for Android user interface uses tabs for easy and swift
changes of context, for example between editing and performing. All
tabs share the same builtin instance of Csound. This enables, for
example, a piece to be written in HTML5 but utilize the builtin
widgets, and so forth. The tabs are:</p>
<ul>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Editor</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><font size="3" style="font-size: 12pt"><span style="font-style: normal"><span style="font-weight: normal">Provides
	a built-in text editor based on Ace, with find and replace
	functionalit</span></span></font></span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">y.
	Touch the editor screen to enable a context menu (a little box with
	three dots), from which you can select the </span></span></span><span style="font-variant: normal"><i><b>Find</b></i></span><span style="font-variant: normal">
	</span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">command.</span></span></span></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Messages</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Shows
	all diagnostic and informative messages printed by Csound.</span></span></span></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>HTML</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	a built-in HTML5-enabled Web browser for the display of custom user
	interfaces, computer graphics and animations, and so on.</span></span></span></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Widgets</b></i><span style="font-variant: normal"> –
	</span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	a predefined set of 12 buttons, 12</span></span></span><span style="font-variant: normal">
	</span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">sliders
	and a trackpad that send updates to predefined Csound control
	channels. These widgets are backwards compatible with previous
	versions of the Csound for Android app.</span></span></span></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Help</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	an embedded browser for the </span></span></span><i><b>Csound
	Reference Manual</b></i><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">.</span></span></span></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>About</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Provides
	an embedded browser for the Csound home page at <a href="http://csound.com/">http://csound.com</a>,
	enabling users to explore many uses and features of Csound.</span></span></span></p>
</ul>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
task menu of Csound for Android provides the following functions: 
</p>
<ul>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>New</b></i> – Creates a blank template Csound .csd file in
	the root directory of the user's storage for the user to edit. The
	.csd file will be remembered and performed by Csound.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Open</b></i> – Opens a file for editing. The file can be a
	Csound .csd file, or an HTML5 .html file. Each of these languages
	has access to the same instance of Csound that is exposed in the
	HTML tab or to the widgets in the Widgets tab.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Save as...</b></i> <span style="font-variant: normal">–
	Saves the current .csd or other file being edited under a new name.</span></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Save</b></i><span style="font-variant: normal"> – </span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">Saves
	the current .csd</span></span></span><span style="font-variant: normal">
	</span><span style="font-variant: normal"><span style="font-style: normal"><span style="font-weight: normal">or
	other file being edited to the user’s storage.</span></span></span></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<i><b>Run/Stop</b></i> – If Csound is not running, starts a
	performance; if Csound is running, stops the performance. If the
	file is an .html file, it is reloaded in the HTML tab which has
	access to a Csound object encapsulating the app’s builtin instance
	of Csound. If the Csound options include <font face="Courier New, monospace">-odac</font><font face="Liberation Serif, serif">,
	Csound's audio output will go to the device audio output. If the
	element contains </font><font face="Courier New, monospace">-osoundfilename</font><font face="Liberation Serif, serif">,
	Csound's audio output will go to the file </font><font face="Courier New, monospace">soundfilename</font><font face="Liberation Serif, serif">,
	which should be a valid Linux pathname in the user's storage
	filesystem.</font> 
	</p>
</ul>
<ul>
	<li><p style="margin-top: 0.04in; margin-bottom: 0.12in"><i><b>Examples</b></i>
	– Opens a submenu with various built-in example pieces. These are
	saved in your device's external public storage Music directory, and
	then run.</p>
	<li><p style="line-height: 115%"><i><b>User guide</b></i> – Opens
	this basic user guide.</p>
	<li><p style="line-height: 115%"><i><b>Settings</b></i> – Includes
	the following choices. The values of the settings are saved on the
	device, and restored at the beginning of the next session. Please
	note, it may be necessary to provide the full path to the Csound
	app’s public data directory as the value of each directory, or as
	the first part of each directory. This information is printed by the
	Csound app in the Messages pane when it first starts.</p>
	<ul>
		<li><p style="line-height: 115%"><i><b>Plugins directory</b></i> –
		Sets the value of the OPCODE6DIR64 environment variable.</p>
		<li><p style="line-height: 115%"><i><b>Output directory</b></i> –
		Sets the value of the SFDIR environment variable. 
		</p>
		<li><p style="line-height: 115%"><i><b>Samples directory</b></i> –
		Sets the value of the SSDIR environment variable.</p>
		<li><p style="line-height: 115%"><i><b>Analysis directory</b></i> –
		Sets the value of the SADIR environment variable.</p>
		<li><p style="line-height: 115%"><i><b>Include directory</b></i> –
		Sets the value of the INCDIR environment variable.</p>
	</ul>
</ul>
<h2 class="western" style="line-height: 115%">Predefined Widgets</h2>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
predefined widgets on the <i><b>Widgets </b></i>tab are assigned
control channel names <font face="Courier New, monospace">butt1</font>
through <font face="Courier New, monospace">butt12</font>, <font face="Courier New, monospace">slider1</font>
through <font face="Courier New, monospace">slider12</font>,
<font face="Courier New, monospace">trackpad.x</font>, and
<font face="Courier New, monospace">trackpad.y</font>. In addition,
the accelerometer on the Android device is available as
<font face="Courier New, monospace">accelerometerX</font>,
<font face="Courier New, monospace">accelerometerY</font>, and
<font face="Courier New, monospace">accelerometerZ</font>. 
</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
values of these widgets are normalized between 0 and 1, and can be
read into Csound during performance using the <font face="Courier New, monospace">chnget</font>
opcode, like this: 
</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in"><font face="Courier New, monospace">kslider1_value
chnget “slider1”</font></p>
<p style="margin-top: 0.04in">The buttons send 1 when pressed, and 0
when released. The trackpad sends the <font face="Courier New, monospace">x</font>
and <font face="Courier New, monospace">y</font> positions whenever
the user is moving his or her finger on the trackpad. These positions
are remembered when the finger is removed.</p>
<h2 class="western" style="line-height: 115%">User-Defined Widgets</h2>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">User-defined
widgets are defined in an HTML file (Web page), or in a new <font face="Courier New, monospace">&lt;html&gt;</font>
element of the CSD file. This can in principle contain any valid
HTML5 code, including document elements, JavaScript, and styles.
JavaScript event handlers can be attached to any elements, including
range inputs (sliders). Such event handlers can call Java methods of
the <font face="Courier New, monospace">CsoundOboe</font> object
(<font face="Courier New, monospace">csound</font>), for example to
get or set control channel values, or to send new score events to
Csound.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
ability to send score events to Csound from JavaScript means that
JavaScript can be used as a high-level programming language in an
.html file for the purposes of algorithmic composition, even
interactive composition. All methods callable from <font face="Courier New, monospace">CsoundAppActivity</font>
and <font face="Courier New, monospace">CsoundOboe</font> are marked
with the <font face="Courier New, monospace">@JavascriptInterface</font>
attribute in the Csound for Android source code. For a basic example
of a user-defined widget setup, see the <span style="text-decoration: none"><font face="Liberation Serif, serif"><i>Message
from Another Planet</i></font></span> example. Here is a snippet
showing a slider's <font face="Courier New, monospace">onInput</font>
event handler setting a Csound control channel:</p>
<pre class="western" style="line-height: 115%; page-break-inside: avoid; page-break-before: auto; page-break-after: auto">&lt;script&gt;
function gk_Reverb_FeedbackUpdate(value) {
    var numberValue = parseFloat(value)
    csoundApp.setControlChannel('gk_Reverb_Feedback', numberValue);
}
&lt;/script&gt;</pre><h1 class="western">
Running on Other Operating Systems</h1>
<p>The Csound for Android app can run on any desktop operating system
that has an Android emulator installed. This can sometimes provide
higher performance or a better user interface than running on an
actual Android device. It makes the Csound for Android app into a
cross-platform, universal build of Csound. 
</p>
<p>Here I will document the use of Android Studio to create and run
an Android emulator on macOS. The procedure would be much on the same
on Windows or Linux. For users who do not wish to install and
configure Android Studio, which is a bit of a heavyweight, I will
also mention some other Android emulators.</p>
<h2 class="western">Android Studio as an Emulator</h2>
<p>Install Android Studio using the download, installation, and
configuration instructions <a href="https://developer.android.com/studio">here</a>.</p>
<p>To create an emulator, create a virtual device for Android 13 (but
some versions of Android should also work). Run Android Studio. Use
the <b>Tools</b> menu, <b>Device Manager </b>command to open the
<b>Device Manager</b> panel. Use the <b>Create Device</b> button to
create a virtual device. You can select a preconfigured device that
is similar to the device you need to emulate using the <b>Choose a
device definition</b> button, or you can use the <b>New Hardware
Profile</b> button to open the <b>Virtual Device Configuration</b>
dialog. If you plan to perform Csound pieces on the emulator,
consider creating a new virtual device with the optimal display for
your computer, and with as much memory as your computer can support.
If the amount of memory provided does not seem sufficient, configure
Android Studio itself to run the Java virtual machine with a larger
heap.</p>
<p>To run Csound for Android:</p>
<ul>
	<li><p>If your emulator supports the Google Play Store, go there in
	the emulator and install the app from here.</p>
	<li><p>If your emulator does not support the Google Play Store,
	download the .apk file from the <a href="https://github.com/gogins/csound-android/releases/">Csound
	for Android GitHub repository</a>, run the emulator, and drag and
	drop the .apk file on the emulator screen. It will automatically be
	installed.</p>
</ul>
<p>You can run the emulator directly from a terminal, e.g. on macOS
execute: <font face="Courier New, monospace"><font size="3" style="font-size: 12pt">/Users/michaelgogins/Library/Android/sdk/emulator/emulator
-avd Perform_Csds_API_34 -netdelay none -netspeed full</font></font>.
Use the -<font face="Courier New, monospace">help</font> option to
view all command-line options for the emulator. For example, <font face="Courier New, monospace">-memory
&lt;megabytes&gt;</font> will configure the emulator’s heap size. 
</p>
<p>Of course, if you use the emulator often, you can create a shell
script and/or desktop shortcut to run it in one step.</p>
<h2 class="western">Other Android Emulators</h2>
<p>In addition to using Android Studio, it is also possible to use
other Android emulators such as <a href="https://www.oracle.com/virtualization/virtualbox/">VirtualBox</a>
(<a href="https://www.coolmuster.com/android/run-android-on-mac.html">setup
for Android instructions here</a>), <a href="https://www.bignox.com/">NoxPlayer</a>,
or <a href="https://www.bluestacks.com/">Bluestacks</a>. 
</p>
<p>Be aware that using any Android emulator may involve security
risks. However, downloading the emulator only from the official
vendor’s download site, scanning the download for malware, and
being wary of the same things one would be wary of when running any
Android app should minimize the risks to an acceptable level. After
all, hundreds of millions of people use these emulators.</p>
<h1 class="western" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
Examples</h1>
<h2 class="western">Built-In Examples</h2>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
menu of the Csound app features a number of built-in examples.
Selecting an example will cause its file or files to be copied to the
app's external public storage Music directory and loaded into the
app, ready to be performed or edited. Not all of the examples use the
widgets. The examples demonstrate not only some techniques for using
the Csound6 Android app, but also a few of the many different ways of
making music with Csound.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">When
I first encountered the Csound app, I was very impressed. Now that I
have been able to contribute to its development, I have come to
realize that a high end smartphone, not to mention a tablet, is in
every sense of the word a real computer. The limits to what can be
programmed on it are indefinable. On a high-end personal computer, it
is easier to type, and Csound runs quite a bit faster; but there is
no <i>essential</i> difference between running Csound on a computer
and running it on a smartphone.</p>
<h2 class="western">A Tutorial Example</h2>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">This
example will take you through the process of creating a new Csound
piece, step by step. Obviously, this piece is not going to reveal
anything like the full power of Csound. It is only intended to get
you to the point of being able to create, edit, and run a Csound
piece that will actually make sound on your Android device – from
scratch.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">Run
the Csound app...</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">Press
the <b>New...</b> button. You should be presented with an input
dialog asking you for a filename for your piece. Type in <font face="Courier New, monospace">toot.csd</font>,
and press the <b>Ok</b> button. The file will be stored in the root
directory of your user storage on your device. You can save the file
to another place , if you like.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
text editor should now contain a “template” .csd file. Your job
is to fill out the minimum to hear something.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">Create
a blank line between <font face="Courier New, monospace">&lt;CsOptions&gt;</font>
and <font face="Courier New, monospace">&lt;/CsOptions&gt;</font>,
and type <font face="Courier New, monospace">-odac -d -m3</font>.
This means send audio to the real-time output (<font face="Courier New, monospace">-odac</font>),
do not display any function tables (<font face="Courier New, monospace">-d</font>),
and log some informative messages during Csound's performance (<font face="Courier New, monospace">-m3</font>).</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">Create
a blank line between <font face="Courier New, monospace">&lt;CsInstruments&gt;</font>
and <font face="Courier New, monospace">&lt;/CsInstruments&gt;</font>
and type the following text:</p>
<pre class="western" style="line-height: 115%; margin-top: 0.04in; margin-bottom: 0.08in">sr = 44100
ksmps = 10
nchnls = 1
<font color="#000000"><font face="Courier New, monospace"><font size="2" style="font-size: 9pt">instr 1</font></font></font>
asignal oscil 10000, 440
<font face="Courier New, monospace"><font size="2" style="font-size: 9pt">out asignal</font></font>
<font face="Courier New, monospace"><font size="2" style="font-size: 9pt">endin</font></font></pre><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
This is just about the simplest possible Csound orchestra. The
orchestra header specifies an audio signal sampling rate of 44,100
frames per second, with 10 audio frames per control signal sample,
and one channel of audio output. The instrument is just a simple sine
oscillator. It plays a loud tone at concert A.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">Create
a blank line between <font face="Courier New, monospace">&lt;CsScore&gt;</font>
and <font face="Courier New, monospace">&lt;/CsScore&gt;</font> and
type:</p>
<pre class="western" style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0.08in">i1 0 5</pre><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
This means play instrument 1 starting at time 0 for 5 seconds.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">Invoke
the <b>Save</b> menu item.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">Press
the Csound app's <b>Start</b> button. You should hear a loud sine
tone for 5 seconds.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">If
you want to save your audio output to a soundfile named <font face="Courier New, monospace">test.wav</font>,
change <font face="Courier New, monospace">-odac</font> above to
<font face="Courier New, monospace">-o/sdcard/test.wav</font>.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">That's
it!</p>
<h1 class="western">Issues and Workarounds</h1>
<h2 class="western">Audio Performance</h2>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">The
Android operating system has only recently been given an audio driver
layer, AAudio, that is even marginally adequate for musical use. Only
recent devices support this, and even some of them have issues. The
Oboe driver used by this app can be configured by the user for either
AAudio or the older OpenSL ES audio driver to suit your device.</p>
<p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">If
you experiences glitches or low latency, try the following:</p>
<ul>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	Look at the Csound messages to see which driver Oboe is using, and
	use the <i><b>Settings</b></i>, <i><b>Audio drive</b></i>r choice to
	set the other one.</p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	Experiment with Csound’s <font face="Courier New, monospace">ksmps
	</font><font face="Liberation Serif, serif">option in the orchestra
	header.</font></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<font face="Liberation Serif, serif">Close all other apps on your
	device, and clear all caches.</font></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<font face="Liberation Serif, serif">Turn on Airplane Mode.</font></p>
	<li><p style="line-height: 115%; margin-top: 0.08in; margin-bottom: 0in">
	<font face="Liberation Serif, serif">Experiment with your device’s
	Power Saving or Performance mode.</font></p>
</ul>
<h2 class="western">File System</h2>
<p>The Android operating system has new and sometimes awkward
security restrictions on how applications can read and write files on
your device. 
</p>
<p>In Android 10, applications are required to specify any storage
directories on which the user might write files. For the Csound for
Android app, the default public storage directory is <font face="Courier New, monospace">Music</font>,
which on many devices is <span style="font-variant: normal"><font face="Courier New, monospace"><span style="font-style: normal">/storage/emulated/0/Music</span></font></span><span style="font-variant: normal"><span style="font-style: normal">.
If your pieces cannot read or write some file, such as a SoundFont,
sample soundfile, include file, or anything else, try putting
everything in this directory. Subdirectories of this should also
work. On startup, you can look at the </span></span><i><b>Messages</b></i><span style="font-variant: normal">
</span><span style="font-variant: normal"><span style="font-style: normal">pane
to see what Csound is actually using for the public data directory.</span></span></p>
<p><span style="font-variant: normal"><span style="font-style: normal">From
Android 11 on, security restrictions have made it more and more
difficult to read and write files. For this reason, the Csound for
Android app requests</span></span><span style="font-variant: normal">
</span><span style="font-variant: normal"><span style="font-style: normal">the
</span></span><span style="font-variant: normal"><font face="Courier New, monospace"><span style="font-style: normal">MANAGE_EXTERNAL_STORAGE</span></font></span><span style="font-variant: normal">
</span><span style="font-variant: normal"><span style="font-style: normal">permission,
which allows the app to read and write files anywhere on a device.
However, rest assured that the app never, on its own, reads any
private information, or sends any private information anywhere, or
downloads any data or any software on its own. Of course, a user can
write a Csound piece that can do these things, so exercise due care.</span></span></p>
<h2 class="western">Screen Sizes</h2>
<p>The sizes of fonts and widgets in the Csound for Android app can
be configured to some extent in the device’s Android settings,
namely in the <i><b>Settings</b></i>, <i><b>Display</b></i>, <i><b>Font
size and style</b></i> section and <i><b>Screen zoom</b></i> section.</p>
<h2 class="western">Editor</h2>
<p>The Ace editor used in this app currently has some issues.</p>
<ul>
	<li><p>The user should touch the editor to bring up the virtual
	keyboard, only in text above where the keyboard will appear.</p>
	<li><p>A context menu (three dots) appears when the editor is
	touched. The <i><b>Select All</b></i>, <i><b>Cut</b></i>, and <i><b>Find</b></i>
	(and <i><b>Replace</b></i>) commands work, but the <i><b>Paste</b></i>
	and <i><b>Undo</b></i> commands do not work. However, the standard
	Android select, copy, cut, and paste operations <i>do</i> work. 
	</p>
	<li><p>The scrollbars operate in a manner that might not be
	intuitive for desktop users. The visible bars at the left and bottom
	of the editor are the scrollbar “thumbs”, and on a mobile device
	they are not draggable except as part of the editor panel. Rather,
	the thumbs simply indicate the relative size and position of the
	visible document with respect to the entire document. To scroll,
	simply touch a scrollbar (the very leftmost or bottommost part of
	the screen, where the thumbs appear) and the editor will jump to the
	corresponding position in the document.</p>
</ul>
<h2 class="western">HTML Pieces</h2>
<p>When an HTML example loads, the app may briefly display a popup
message about a missing <font face="Courier New, monospace">csound.js</font>
file. This message can be ignored and should not recur. The piece
should render properly anyway.</p>
<p>If the HTML for the piece is not rendered correctly, it may help
to exit the app and reload the piece.</p>
<p>In general, for HTML pieces, it is necessary to click on the <i><b>Run</b></i>
button, as for any other Csound piece, before Csound is instantiated
in the JavaScript context and can render the piece.</p>
<h2 class="western">Debugging Crashes</h2>
<p>If Csound crashes when it starts, or while it is running, then the
Csound for Android app simply exits without warning or information.</p>
<p>That is because Csound is written in C, and the C runtime library
handles crashes using signal handlers or an atexit function. But the
Csound for Android app is written in Java, and runs on a Java virtual
machine. When a fatal error occurs, the signal handler is duly
called, but the state of the Java virtual machine at that time cannot
be known. Therefore, the results of calling Java code from the signal
handler cannot be determined. And so, it’s not possible to throw a
Java exception or to call from the signal handler back into Java to
show an alert from the signal handler.</p>
<p>However, it is still possible to figure out what caused the crash.
This is done by putting a diagnostic print statement such as <font face="Courier New, monospace">prints
“Got this far…\n”</font> in your Csound orchestra code,
starting in the orchestra header, and moving this print statement
around in the orchestra until the app crashes before you see the
message. That must be just after where the crash happened, so you can
often figure out the cause of the crash by the carefully reading the
code that runs just before the unprinted print statement.</p>
<h1 class="western"><br/>
<br/>

</h1>
</body>
</html>